<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="mobile-web-app-capable" content="yes">
<title>–û–Ω–ª–∞–π–Ω –ó–º—ñ–Ω–∞</title>
<link rel="icon" href="https://i.imgur.com/lSeLN06.png" type="image/png">
<link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<style>
  body {
    font-family: 'Comfortaa', sans-serif;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    background: #000000 url('https://i.imgur.com/JNKW51n.png');
    background-size: cover;
    background-position: center center;
    background-repeat: no-repeat;
    background-attachment: fixed;
    transition: all 0.3s ease;
  }
  .container {
    width: 90%;
    max-width: 500px;
    background-color: rgba(21, 21, 29, 0.9);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.5);
    color: #fff;
    text-align: center;
    position: relative;
    transition: all 0.3s ease;
  }
  .container h1 {
    margin-bottom: 20px;
    font-size: 24px;
  }
  .container h2 {
    font-size: 20px;
  }
  .banner {
    width: 100%;
    height: 150px;
    background: url('https://i.imgur.com/qt6wcPg.jpeg') no-repeat center;
    background-size: cover;
    border-radius: 10px;
    margin-bottom: 20px;
    filter: drop-shadow(5px 5px 10px #000000);
  }
  .block {
    margin-bottom: 20px;
    text-align: left;
    padding: 15px;
    border: 1px solid rgba(0, 123, 255, 0.2);
    border-radius: 5px;
    background-color: rgba(50, 50, 60, 0.8);
    transition: all 0.3s ease;
  }
  .block:hover {
    border-color: rgba(0, 123, 255, 0.5);
    box-shadow: 0 0 10px rgba(0, 123, 255, 0.2);
  }
  label {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
    font-size: 14px;
  }
  label i {
    margin-right: 10px;
    color: #007BFF;
  }
  input, select, button {
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    margin-top: 5px;
    box-sizing: border-box;
    font-family: 'Comfortaa', sans-serif;
    resize: none;
  }
  input, select {
    background-color: rgba(21, 21, 29, 0.9);
    color: white;
    transition: all 0.3s ease;
  }
  input:focus, select:focus {
    outline: none;
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.5);
  }
  button {
    background-color: #007BFF;
    color: white;
    cursor: pointer;
    margin-top: 10px;
    position: relative;
    overflow: hidden;
    transition: background-color 0.3s ease;
    font-weight: bold;
  }
  button:hover {
    background-color: #0056b3;
  }
  button:disabled {
    background-color: #cccccc;
    cursor: not-allowed;
  }
  .radio-group {
    display: flex;
    flex-direction: column;
  }
  .radio-group label {
    flex: 1;
    text-align: center;
    background-color: #0F0F16;
    padding: 12px;
    border-radius: 5px;
    margin: 5px 0;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  .radio-group label:hover {
    background-color: #1a1a24;
  }
  .radio-group input {
    display: none;
  }
  .radio-group input:checked + label {
    background-color: #007BFF;
    color: white;
  }
  .button-cooldown {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, rgba(0, 123, 255, 0.5) 0%, rgba(0, 123, 255, 0.8) 50%, rgba(0, 123, 255, 0.5) 100%);
    transform: translateX(-100%);
    transition: transform 30s linear;
  }
  .button-text {
    position: relative;
    z-index: 1;
  }
  .notifications-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1000;
    width: 300px;
    max-width: 100%;
  }
  .notification {
    background-color: rgba(21, 21, 29, 0.9);
    color: #fff;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 10px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    display: flex;
    flex-direction: column;
    animation: slideIn 0.5s ease-out;
    position: relative;
    overflow: hidden;
  }
  .notification::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 5px;
    background: linear-gradient(to right, #007BFF, #00a8ff);
  }
  .notification-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }
  .notification-title {
    font-weight: bold;
    font-size: 16px;
    display: flex;
    align-items: center;
  }
  .notification-title i {
    margin-right: 8px;
  }
  .notification-close {
    background: none;
    border: none;
    color: #fff;
    font-size: 20px;
    cursor: pointer;
    padding: 0;
    opacity: 0.7;
    transition: opacity 0.3s ease;
  }
  .notification-close:hover {
    opacity: 1;
  }
  .notification-content {
    font-size: 14px;
    line-height: 1.4;
  }
  .notification-time {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.7);
    align-self: flex-end;
    margin-top: 5px;
  }
  .notification.success::before {
    background: linear-gradient(to right, #28a745, #5cb85c);
  }
  .notification.error::before {
    background: linear-gradient(to right, #dc3545, #d9534f);
  }
  .notification.warning::before {
    background: linear-gradient(to right, #ffc107, #ffdb58);
  }
  .notification.info::before {
    background: linear-gradient(to right, #17a2b8, #5bc0de);
  }
  @keyframes slideIn {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
  .hidden {
    display: none;
  }
  .visible {
    display: block;
    animation: fadeIn 0.5s ease-out;
  }
  .action-card {
    background-color: rgba(50, 50, 60, 0.8);
    border-radius: 10px;
    padding: 20px;
    margin: 10px 0;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 1px solid rgba(0, 123, 255, 0.2);
  }
  .action-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    border-color: rgba(0, 123, 255, 0.5);
  }
  .action-card i {
    font-size: 30px;
    margin-bottom: 10px;
    color: #007BFF;
  }
  .action-card h3 {
    margin: 10px 0;
  }
  .action-card p {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.7);
  }
  .stats-container {
    display: flex;
    justify-content: space-between;
    margin-bottom: 20px;
  }
  .stat-box {
    flex: 1;
    background-color: rgba(50, 50, 60, 0.8);
    border-radius: 10px;
    padding: 15px;
    margin: 0 5px;
    text-align: center;
  }
  .stat-box h4 {
    margin: 0 0 5px 0;
    font-size: 14px;
    color: rgba(255, 255, 255, 0.7);
  }
  .stat-box p {
    margin: 0;
    font-size: 18px;
    font-weight: bold;
  }
  .tab-container {
    margin-bottom: 20px;
  }
  .tab-buttons {
    display: flex;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }
  .tab-button {
    flex: 1;
    background: none;
    border: none;
    padding: 10px;
    color: rgba(255, 255, 255, 0.7);
    cursor: pointer;
    margin: 0;
    transition: all 0.3s ease;
  }
  .tab-button.active {
    color: #fff;
    border-bottom: 2px solid #007BFF;
  }
  .tab-content {
    padding: 15px 0;
  }
  .tab-pane {
    display: none;
  }
  .tab-pane.active {
    display: block;
    animation: fadeIn 0.5s ease-out;
  }
  .shift-history {
    max-height: 300px;
    overflow-y: auto;
  }
  .shift-item {
    background-color: rgba(50, 50, 60, 0.8);
    border-radius: 5px;
    padding: 10px;
    margin-bottom: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .shift-date {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.7);
  }
  .shift-time {
    font-weight: bold;
  }
  .shift-duration {
    background-color: #007BFF;
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 12px;
  }
  .back-button {
    background: none;
    border: none;
    color: #007BFF;
    cursor: pointer;
    display: flex;
    align-items: center;
    padding: 0;
    margin-bottom: 15px;
    font-size: 14px;
    width: auto;
  }
  .back-button i {
    margin-right: 5px;
  }
  .profile-picture {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background-color: #007BFF;
    margin: 0 auto 15px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 30px;
    color: white;
  }
  .welcome-message {
    font-size: 22px;
    margin-bottom: 20px;
    animation: fadeIn 0.5s ease-out;
  }
  .welcome-message span {
    color: #007BFF;
    font-weight: bold;
  }
  .active-shift-indicator {
    background-color: rgba(40, 167, 69, 0.2);
    border: 1px solid rgba(40, 167, 69, 0.5);
    color: #28a745;
    padding: 10px;
    border-radius: 5px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .active-shift-indicator i {
    margin-right: 10px;
  }
  .active-shift-time {
    font-weight: bold;
  }
  .loader {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top-color: #fff;
    animation: spin 1s ease-in-out infinite;
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  .remember-me {
    display: flex;
    align-items: center;
    margin-top: 10px;
  }
  .remember-me input {
    width: auto;
    margin-right: 10px;
  }
  .remember-me label {
    margin-bottom: 0;
  }
  .forgot-password {
    text-align: right;
    margin-top: 10px;
  }
  .forgot-password a {
    color: #007BFF;
    text-decoration: none;
    font-size: 14px;
  }
  .forgot-password a:hover {
    text-decoration: underline;
  }
  .divider {
    display: flex;
    align-items: center;
    margin: 20px 0;
  }
  .divider::before, .divider::after {
    content: '';
    flex: 1;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }
  .divider span {
    padding: 0 10px;
    color: rgba(255, 255, 255, 0.5);
    font-size: 14px;
  }
  .status-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 10px;
    font-size: 14px;
    color: rgba(255, 255, 255, 0.7);
  }
  .status-indicator .loader {
    width: 14px;
    height: 14px;
    margin-right: 8px;
  }
  .status-indicator.success {
    color: #28a745;
  }
  .status-indicator.error {
    color: #dc3545;
  }
  .status-indicator i {
    margin-right: 8px;
  }
  @media (min-width: 768px) {
    .container {
      width: 500px;
      padding: 30px;
    }
    .radio-group {
      flex-direction: row;
    }
    .radio-group label {
      margin: 0 5px;
    }
  }
</style>
</head>
<body>
<div class="notifications-container" id="notificationsContainer"></div>

<div class="container" id="mainContainer">
  <div class="banner"></div>
  
  <!-- –§–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó -->
  <div id="loginForm" class="visible">
    <h1>–û–Ω–ª–∞–π–Ω –ó–º—ñ–Ω–∞ –ß–£–ü–ê–ß–£–ü–°–êüç≠</h1>
    <h2><span style="color: #9A9893;">* * *</span></h2>
    <p>–£–≤—ñ–π–¥—ñ—Ç—å —É —Å–∏—Å—Ç–µ–º—É –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å</p>
    
    <div class="tab-container">
      <div class="tab-buttons">
        <button class="tab-button active" data-tab="login">–í—Ö—ñ–¥</button>
        <button class="tab-button" data-tab="register">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</button>
      </div>
      
      <div class="tab-content">
        <!-- –í–∫–ª–∞–¥–∫–∞ –≤—Ö–æ–¥—É -->
        <div class="tab-pane active" id="login">
          <form id="loginFormElement">
            <div class="block">
              <label for="loginEmail"><i class="fas fa-envelope"></i> –ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞:</label>
              <input type="email" id="loginEmail" name="email" placeholder="–í–≤–µ–¥—ñ—Ç—å –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É" required>
            </div>
            
            <div class="block">
              <label for="loginNickname"><i class="fas fa-user"></i> –ù—ñ–∫–Ω–µ–π–º:</label>
              <input type="text" id="loginNickname" name="nickname" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω—ñ–∫–Ω–µ–π–º" required>
            </div>
            
            <div class="block">
              <label for="loginPassword"><i class="fas fa-lock"></i> –ü–∞—Ä–æ–ª—å:</label>
              <input type="password" id="loginPassword" name="password" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å" required>
            </div>
            
            <div class="remember-me">
              <input type="checkbox" id="rememberMe" name="rememberMe">
              <label for="rememberMe">–ó–∞–ø–∞–º'—è—Ç–∞—Ç–∏ –º–µ–Ω–µ</label>
            </div>
            
            <div class="forgot-password">
              <a href="#" id="forgotPasswordLink">–ó–∞–±—É–ª–∏ –ø–∞—Ä–æ–ª—å?</a>
            </div>
            
            <button type="submit" id="loginButton">
              <span class="button-text">–£–≤—ñ–π—Ç–∏</span>
            </button>
          </form>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó -->
        <div class="tab-pane" id="register">
          <form id="registerFormElement">
            <div class="block">
              <label for="registerEmail"><i class="fas fa-envelope"></i> –ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞:</label>
              <input type="email" id="registerEmail" name="email" placeholder="–í–≤–µ–¥—ñ—Ç—å –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É" required>
            </div>
            
            <div class="block">
              <label for="registerNickname"><i class="fas fa-user"></i> –ù—ñ–∫–Ω–µ–π–º:</label>
              <input type="text" id="registerNickname" name="nickname" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω—ñ–∫–Ω–µ–π–º" required>
            </div>
            
            <div class="block">
              <label for="registerPassword"><i class="fas fa-lock"></i> –ü–∞—Ä–æ–ª—å:</label>
              <input type="password" id="registerPassword" name="password" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å" required>
            </div>
            
            <div class="block">
              <label for="registerPasswordConfirm"><i class="fas fa-lock"></i> –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è:</label>
              <input type="password" id="registerPasswordConfirm" name="passwordConfirm" placeholder="–ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å" required>
            </div>
            
            <button type="submit" id="registerButton">
              <span class="button-text">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</span>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
  
  <!-- –ì–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω –ø—ñ—Å–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó -->
  <div id="dashboardScreen" class="hidden">
    <button class="back-button" id="logoutButton">
      <i class="fas fa-sign-out-alt"></i> –í–∏–π—Ç–∏
    </button>
    
    <div class="profile-picture" id="profilePicture"></div>
    <div class="welcome-message">–í—ñ—Ç–∞—é, <span id="userNameDisplay">–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á</span>!</div>
    
    <!-- –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ—ó –∑–º—ñ–Ω–∏ -->
    <div class="active-shift-indicator hidden" id="activeShiftIndicator">
      <div>
        <i class="fas fa-clock"></i>
        <span>–ê–∫—Ç–∏–≤–Ω–∞ –∑–º—ñ–Ω–∞ –∑ </span>
        <span class="active-shift-time" id="activeShiftTime">00:00</span>
      </div>
      <button id="endActiveShiftButton" class="back-button">
        –ó–∞–∫—ñ–Ω—á–∏—Ç–∏ <i class="fas fa-arrow-right"></i>
      </button>
    </div>
    
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="stats-container">
      <div class="stat-box">
        <h4>–í—Å—å–æ–≥–æ –∑–º—ñ–Ω</h4>
        <p id="totalShiftsCount">0</p>
      </div>
      <div class="stat-box">
        <h4>–¶—å–æ–≥–æ —Ç–∏–∂–Ω—è</h4>
        <p id="weeklyHours">0 –≥–æ–¥</p>
      </div>
      <div class="stat-box">
        <h4>–°–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å</h4>
        <p id="averageTime">0 –≥–æ–¥</p>
      </div>
    </div>
    
    <h2>–û–±–µ—Ä–∏ –¥—ñ—é:</h2>
    
    <!-- –ö–∞—Ä—Ç–∫–∏ –¥—ñ–π -->
    <div id="actionCards">
      <div class="action-card" id="startShiftCard">
        <i class="fas fa-play-circle"></i>
        <h3>–ü–æ—á–∞—Ç–∏ –∑–º—ñ–Ω—É</h3>
        <p>–ó–∞—Ñ—ñ–∫—Å—É–≤–∞—Ç–∏ –ø–æ—á–∞—Ç–æ–∫ —Ä–æ–±–æ—á–æ–≥–æ —á–∞—Å—É</p>
      </div>
      
      <div class="action-card" id="viewHistoryCard">
        <i class="fas fa-history"></i>
        <h3>–Ü—Å—Ç–æ—Ä—ñ—è –∑–º—ñ–Ω</h3>
        <p>–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∑–º—ñ–Ω–∏</p>
      </div>
      
      <div class="action-card" id="profileSettingsCard">
        <i class="fas fa-user-cog"></i>
        <h3>–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h3>
        <p>–ó–º—ñ–Ω–∏—Ç–∏ –æ—Å–æ–±–∏—Å—Ç—ñ –¥–∞–Ω—ñ</p>
      </div>
    </div>
  </div>
  
  <!-- –ï–∫—Ä–∞–Ω –ø–æ—á–∞—Ç–∫—É –∑–º—ñ–Ω–∏ -->
  <div id="startShiftScreen" class="hidden">
    <button class="back-button" id="backFromStartShift">
      <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
    </button>
    
    <h1>–ü–æ—á–∞—Ç–æ–∫ –∑–º—ñ–Ω–∏</h1>
    <p>–ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å –ø–æ—á–∞—Ç–æ–∫ –≤–∞—à–æ—ó –∑–º—ñ–Ω–∏</p>
    
    <form id="startShiftForm">
      <div class="block">
        <label for="startShiftTime"><i class="fas fa-clock"></i> –ß–∞—Å –ø–æ—á–∞—Ç–∫—É:</label>
        <input type="time" id="startShiftTime" name="time" required>
      </div>
      
      <button type="submit" id="confirmStartShiftButton">
        <span class="button-text">–ü–æ—á–∞—Ç–∏ –∑–º—ñ–Ω—É</span>
        <span class="button-cooldown"></span>
      </button>
    </form>
  </div>
  
  <!-- –ï–∫—Ä–∞–Ω –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –∑–º—ñ–Ω–∏ -->
  <div id="endShiftScreen" class="hidden">
    <button class="back-button" id="backFromEndShift">
      <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
    </button>
    
    <h1>–ó–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –∑–º—ñ–Ω–∏</h1>
    <p>–ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –≤–∞—à–æ—ó –∑–º—ñ–Ω–∏</p>
    
    <form id="endShiftForm">
      <div class="block">
        <label><i class="fas fa-hourglass-start"></i> –ß–∞—Å –ø–æ—á–∞—Ç–∫—É:</label>
        <div id="displayStartTime" class="active-shift-time">00:00</div>
      </div>
      
      <div class="block">
        <label for="endShiftTime"><i class="fas fa-hourglass-end"></i> –ß–∞—Å –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è:</label>
        <input type="time" id="endShiftTime" name="time" required>
      </div>
      
      <button type="submit" id="confirmEndShiftButton">
        <span class="button-text">–ó–∞–∫—ñ–Ω—á–∏—Ç–∏ –∑–º—ñ–Ω—É</span>
        <span class="button-cooldown"></span>
      </button>
    </form>
  </div>
  
  <!-- –ï–∫—Ä–∞–Ω —ñ—Å—Ç–æ—Ä—ñ—ó –∑–º—ñ–Ω -->
  <div id="historyScreen" class="hidden">
    <button class="back-button" id="backFromHistory">
      <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
    </button>
    
    <h1>–Ü—Å—Ç–æ—Ä—ñ—è –∑–º—ñ–Ω</h1>
    <p>–í–∞—à—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∑–º—ñ–Ω–∏</p>
    
    <div class="shift-history" id="shiftHistoryContainer">
      <!-- –¢—É—Ç –±—É–¥—É—Ç—å –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—è –∑–∞–ø–∏—Å–∏ —ñ—Å—Ç–æ—Ä—ñ—ó –∑–º—ñ–Ω -->
      <div class="status-indicator">
        <div class="loader"></div>
        <span>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó...</span>
      </div>
    </div>
  </div>
  
  <!-- –ï–∫—Ä–∞–Ω –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –ø—Ä–æ—Ñ—ñ–ª—é -->
  <div id="profileScreen" class="hidden">
    <button class="back-button" id="backFromProfile">
      <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
    </button>
    
    <h1>–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é</h1>
    <p>–ó–º—ñ–Ω—ñ—Ç—å –≤–∞—à—ñ –æ—Å–æ–±–∏—Å—Ç—ñ –¥–∞–Ω—ñ</p>
    
    <form id="profileForm">
      <div class="block">
        <label for="profileEmail"><i class="fas fa-envelope"></i> –ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞:</label>
        <input type="email" id="profileEmail" name="email" placeholder="–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞" disabled>
      </div>
      
      <div class="block">
        <label for="profileNickname"><i class="fas fa-user"></i> –ù—ñ–∫–Ω–µ–π–º:</label>
        <input type="text" id="profileNickname" name="nickname" placeholder="–ù—ñ–∫–Ω–µ–π–º" required>
      </div>
      
      <div class="block">
        <label for="profileNewPassword"><i class="fas fa-lock"></i> –ù–æ–≤–∏–π –ø–∞—Ä–æ–ª—å (–∑–∞–ª–∏—à—Ç–µ –ø–æ—Ä–æ–∂–Ω—ñ–º, —â–æ–± –Ω–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏):</label>
        <input type="password" id="profileNewPassword" name="newPassword" placeholder="–ù–æ–≤–∏–π –ø–∞—Ä–æ–ª—å">
      </div>
      
      <div class="block">
        <label for="profileCurrentPassword"><i class="fas fa-shield-alt"></i> –ü–æ—Ç–æ—á–Ω–∏–π –ø–∞—Ä–æ–ª—å (–¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–º—ñ–Ω):</label>
        <input type="password" id="profileCurrentPassword" name="currentPassword" placeholder="–ü–æ—Ç–æ—á–Ω–∏–π –ø–∞—Ä–æ–ª—å" required>
      </div>
      
      <button type="submit" id="saveProfileButton">
        <span class="button-text">–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</span>
      </button>
    </form>
  </div>
  
  <!-- –ï–∫—Ä–∞–Ω –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è -->
  <div id="forgotPasswordScreen" class="hidden">
    <button class="back-button" id="backFromForgotPassword">
      <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
    </button>
    
    <h1>–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è</h1>
    <p>–í–≤–µ–¥—ñ—Ç—å –≤–∞—à—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è</p>
    
    <form id="forgotPasswordForm">
      <div class="block">
        <label for="resetPasswordEmail"><i class="fas fa-envelope"></i> –ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞:</label>
        <input type="email" id="resetPasswordEmail" name="email" placeholder="–í–≤–µ–¥—ñ—Ç—å –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É" required>
      </div>
      
      <button type="submit" id="sendResetLinkButton">
        <span class="button-text">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è</span>
      </button>
    </form>
  </div>
</div>

<script>
  // –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Firebase
  const firebaseConfig = {
     apiKey: "AIzaSyC3NflzgYNlzKXynoEiuuemEY44ufd5_RM",
  authDomain: "online-ukraine-gta.firebaseapp.com",
  databaseURL: "https://online-ukraine-gta-default-rtdb.firebaseio.com",
  projectId: "online-ukraine-gta",
  storageBucket: "online-ukraine-gta.firebasestorage.app",
  messagingSenderId: "965823880422",
  appId: "1:965823880422:web:319df7599b628d2fceaf27",
  measurementId: "G-QPFJ09ZXWB"
  };

  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è Firebase
  let auth, database;
  try {
    firebase.initializeApp(firebaseConfig);
    auth = firebase.auth();
    database = firebase.database();
    console.log("Firebase —É—Å–ø—ñ—à–Ω–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ");
  } catch (error) {
    console.error("–ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó Firebase:", error);
    showNotification('–ü–æ–º–∏–ª–∫–∞', '–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑\'—î–¥–Ω–∞–Ω–Ω—è –∑ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º.', 'error');
  }

  // –ö–µ—à—É–≤–∞–Ω–Ω—è DOM-–µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó
  const elements = {
    notificationsContainer: document.getElementById('notificationsContainer'),
    totalShiftsCount: document.getElementById('totalShiftsCount'),
    weeklyHours: document.getElementById('weeklyHours'),
    averageTime: document.getElementById('averageTime'),
    userNameDisplay: document.getElementById('userNameDisplay'),
    profilePicture: document.getElementById('profilePicture'),
    activeShiftIndicator: document.getElementById('activeShiftIndicator'),
    activeShiftTime: document.getElementById('activeShiftTime'),
    displayStartTime: document.getElementById('displayStartTime'),
    historyContainer: document.getElementById('shiftHistoryContainer'),
    profileEmail: document.getElementById('profileEmail'),
    profileNickname: document.getElementById('profileNickname'),
    startShiftTime: document.getElementById('startShiftTime'),
    endShiftTime: document.getElementById('endShiftTime'),
    forgotPasswordStatus: document.getElementById('forgotPasswordStatus'),
    resetPasswordEmail: document.getElementById('resetPasswordEmail')
  };

  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
  function showNotification(title, message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    
    const notificationHeader = document.createElement('div');
    notificationHeader.className = 'notification-header';
    
    const notificationTitle = document.createElement('div');
    notificationTitle.className = 'notification-title';
    
    let iconClass = 'fa-info-circle';
    if (type === 'success') iconClass = 'fa-check-circle';
    if (type === 'error') iconClass = 'fa-exclamation-circle';
    if (type === 'warning') iconClass = 'fa-exclamation-triangle';
    
    notificationTitle.innerHTML = `<i class="fas ${iconClass}"></i> ${title}`;
    
    const closeButton = document.createElement('button');
    closeButton.className = 'notification-close';
    closeButton.innerHTML = '&times;';
    closeButton.onclick = () => notification.remove();
    
    notificationHeader.appendChild(notificationTitle);
    notificationHeader.appendChild(closeButton);
    
    const content = document.createElement('div');
    content.className = 'notification-content';
    content.textContent = message;
    
    const time = document.createElement('div');
    time.className = 'notification-time';
    time.textContent = new Date().toLocaleTimeString();
    
    notification.appendChild(notificationHeader);
    notification.appendChild(content);
    notification.appendChild(time);
    
    elements.notificationsContainer.appendChild(notification);
    
    setTimeout(() => {
      notification.remove();
    }, 8000);
  }

  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—è –º—ñ–∂ –µ–∫—Ä–∞–Ω–∞–º–∏
  function showScreen(screenId) {
    const screens = [
      'loginForm', 'dashboardScreen', 'startShiftScreen', 
      'endShiftScreen', 'historyScreen', 'profileScreen',
      'forgotPasswordScreen'
    ];
    
    screens.forEach(screen => {
      const element = document.getElementById(screen);
      if (screen === screenId) {
        element.classList.remove('hidden');
        element.classList.add('visible');
      } else {
        element.classList.remove('visible');
        element.classList.add('hidden');
      }
    });
  }

  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—è –º—ñ–∂ –≤–∫–ª–∞–¥–∫–∞–º–∏
  function switchTab(tabId) {
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabPanes = document.querySelectorAll('.tab-pane');
    
    tabButtons.forEach(button => {
      if (button.getAttribute('data-tab') === tabId) {
        button.classList.add('active');
      } else {
        button.classList.remove('active');
      }
    });
    
    tabPanes.forEach(pane => {
      if (pane.id === tabId) {
        pane.classList.add('active');
      } else {
        pane.classList.remove('active');
      }
    });
  }

  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å—É
  function formatTime(date) {
    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
  }

  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ –º—ñ–∂ –¥–≤–æ–º–∞ —á–∞—Å–∞–º–∏
  function calculateDuration(startTime, endTime) {
    const start = new Date(`2000-01-01T${startTime}`);
    const end = new Date(`2000-01-01T${endTime}`);
    
    // –Ø–∫—â–æ –∫—ñ–Ω—Ü–µ–≤–∏–π —á–∞—Å –º–µ–Ω—à–∏–π –∑–∞ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π, –¥–æ–¥–∞—î–º–æ 1 –¥–µ–Ω—å
    if (end < start) {
      end.setDate(end.getDate() + 1);
    }
    
    const diffMs = end - start;
    const diffHrs = Math.floor(diffMs / 3600000);
    const diffMins = Math.round((diffMs % 3600000) / 60000);
    
    return `${diffHrs}:${diffMins.toString().padStart(2, '0')}`;
  }

  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ —á–∞—Å—É —É —Ñ–æ—Ä–º–∞—Ç—ñ HH:MM
  function getCurrentTime() {
    const now = new Date();
    return `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
  }

  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  async function loadUserData(userId) {
    try {
      const userRef = database.ref(`users/${userId}`);
      const snapshot = await userRef.once('value');
      return snapshot.val() || {};
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:', error);
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞', 'error');
      return {};
    }
  }

  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  async function updateUserStats(userId) {
    try {
      const userRef = database.ref(`users/${userId}`);
      const shiftsRef = database.ref(`shifts/${userId}`);
      
      const shiftsSnapshot = await shiftsRef.once('value');
      const shifts = shiftsSnapshot.val() || {};
      
      let totalShifts = 0;
      let totalHours = 0;
      let weeklyHours = 0;
      
      const now = new Date();
      const startOfWeek = new Date(now);
      startOfWeek.setDate(now.getDate() - now.getDay());
      startOfWeek.setHours(0, 0, 0, 0);
      
      Object.values(shifts).forEach(shift => {
        if (shift.endTime) {
          totalShifts++;
          
          const duration = shift.duration || '0:00';
          const [hours, minutes] = duration.split(':').map(Number);
          const durationHours = hours + (minutes / 60);
          
          totalHours += durationHours;
          
          const shiftDate = new Date(shift.date);
          if (shiftDate >= startOfWeek) {
            weeklyHours += durationHours;
          }
        }
      });
      
      const averageTime = totalShifts > 0 ? (totalHours / totalShifts) : 0;
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –µ–ª–µ–º–µ–Ω—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
      elements.totalShiftsCount.textContent = totalShifts;
      elements.weeklyHours.textContent = `${weeklyHours.toFixed(1)} –≥–æ–¥`;
      elements.averageTime.textContent = `${averageTime.toFixed(1)} –≥–æ–¥`;
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –¥–∞–Ω—ñ –≤ –±–∞–∑—ñ
      await userRef.update({
        stats: {
          totalShifts,
          totalHours,
          weeklyHours,
          averageTime
        }
      });
      
      return { totalShifts, totalHours, weeklyHours, averageTime };
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
      return null;
    }
  }

  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –∞–∫—Ç–∏–≤–Ω–æ—ó –∑–º—ñ–Ω–∏
  async function checkActiveShift(userId) {
    try {
      const activeShiftRef = database.ref(`users/${userId}/activeShift`);
      const snapshot = await activeShiftRef.once('value');
      const activeShift = snapshot.val();
      
      if (activeShift) {
        elements.activeShiftTime.textContent = activeShift.startTime;
        elements.displayStartTime.textContent = activeShift.startTime;
        elements.activeShiftIndicator.classList.remove('hidden');
        return activeShift;
      } else {
        elements.activeShiftIndicator.classList.add('hidden');
        return null;
      }
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—ó –∑–º—ñ–Ω–∏:', error);
      return null;
    }
  }

  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó –∑–º—ñ–Ω
  async function loadShiftHistory(userId) {
    try {
      elements.historyContainer.innerHTML = '<div class="status-indicator"><div class="loader"></div><span>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó...</span></div>';
      
      const shiftsRef = database.ref(`shifts/${userId}`).orderByChild('date');
      const snapshot = await shiftsRef.once('value');
      const shifts = snapshot.val() || {};
      
      // –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ –æ–±'—î–∫—Ç –≤ –º–∞—Å–∏–≤ —ñ —Å–æ—Ä—Ç—É—î–º–æ –∑–∞ –¥–∞—Ç–æ—é (–≤—ñ–¥ –Ω–∞–π–Ω–æ–≤—ñ—à–∏—Ö)
      const shiftsArray = Object.entries(shifts).map(([id, shift]) => ({
        id,
        ...shift
      })).sort((a, b) => new Date(b.date) - new Date(a.date));
      
      elements.historyContainer.innerHTML = '';
      
      if (shiftsArray.length === 0) {
        elements.historyContainer.innerHTML = '<p>–£ –≤–∞—Å —â–µ –Ω–µ–º–∞—î –∑–∞–≤–µ—Ä—à–µ–Ω–∏—Ö –∑–º—ñ–Ω</p>';
        return [];
      }
      
      const completedShifts = [];
      
      shiftsArray.forEach(shift => {
        if (shift.endTime) { // –ü–æ–∫–∞–∑—É—î–º–æ —Ç—ñ–ª—å–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ñ –∑–º—ñ–Ω–∏
          completedShifts.push(shift);
          
          const shiftItem = document.createElement('div');
          shiftItem.className = 'shift-item';
          
          const shiftInfo = document.createElement('div');
          
          const shiftDate = document.createElement('div');
          shiftDate.className = 'shift-date';
          shiftDate.textContent = new Date(shift.date).toLocaleDateString('uk-UA');
          
          const shiftTime = document.createElement('div');
          shiftTime.className = 'shift-time';
          shiftTime.textContent = `${shift.startTime} - ${shift.endTime}`;
          
          shiftInfo.appendChild(shiftDate);
          shiftInfo.appendChild(shiftTime);
          
          const shiftDuration = document.createElement('div');
          shiftDuration.className = 'shift-duration';
          shiftDuration.textContent = shift.duration || 'N/A';
          
          shiftItem.appendChild(shiftInfo);
          shiftItem.appendChild(shiftDuration);
          
          elements.historyContainer.appendChild(shiftItem);
        }
      });
      
      return completedShifts;
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó –∑–º—ñ–Ω:', error);
      elements.historyContainer.innerHTML = '<div class="status-indicator error"><i class="fas fa-exclamation-circle"></i><span>–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó</span></div>';
      return [];
    }
  }

  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–∏—Ö –≤ Google Sheets –∑ –æ–±—á–∏—Å–ª–µ–Ω–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –∑–º—ñ–Ω
  async function sendToGoogleSheets(data) {
    try {
      // –û—Ç—Ä–∏–º—É—î–º–æ URL –∑ Firebase
      const configRef = database.ref('config04');
      const snapshot = await configRef.once('value');
      const CONFIG = snapshot.val();
      
      if (!CONFIG || !CONFIG.GOOGLE_SHEET_URL) {
        throw new Error('–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ URL Google Sheets');
      }
      
      // –§–æ—Ä–º–∞—Ç—É—î–º–æ –¥–∞–Ω—ñ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏
      const formData = {
        nickname: data.nickname,
        date: data.date,
        startTime: data.startTime,
        endTime: data.endTime,
        duration: data.duration,
        totalShifts: data.totalShifts || 0,
        weeklyHours: data.weeklyHours || 0,
        averageTime: data.averageTime || 0
      };
      
      console.log('–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–∏—Ö –≤ Google Sheets:', formData);
      
      const response = await fetch(CONFIG.GOOGLE_SHEET_URL, {
        method: 'POST',
        body: new URLSearchParams(formData),
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded',
        }
      });
      
      if (!response.ok) {
        throw new Error('–ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –¥–∞–Ω—ñ –≤ Google Sheets');
      }
      
      console.log('–î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –≤ Google Sheets');
      return true;
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –≤ Google Sheets:', error);
      throw error;
    }
  }

  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–∏—Ö –≤ Discord
  async function sendToDiscord(data) {
    try {
      // –û—Ç—Ä–∏–º—É—î–º–æ URL –∑ Firebase
      const configRef = database.ref('config04');
      const snapshot = await configRef.once('value');
      const CONFIG = snapshot.val();
      
      if (!CONFIG || !CONFIG.DISCORD_WEBHOOK_URL) {
        throw new Error('–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ URL Discord Webhook');
      }
      
      console.log('–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–∏—Ö –≤ Discord:', data);
      
      const response = await fetch(CONFIG.DISCORD_WEBHOOK_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
      
      if (!response.ok) {
        throw new Error('–ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ Discord');
      }
      
      console.log('–î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –≤ Discord');
      return true;
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –≤ Discord:', error);
      throw error;
    }
  }

  // –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π –¥–ª—è –≤–∫–ª–∞–¥–æ–∫
  document.querySelectorAll('.tab-button').forEach(button => {
    button.addEventListener('click', () => {
      const tabId = button.getAttribute('data-tab');
      switchTab(tabId);
    });
  });

  // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è —Ñ–æ—Ä–º–∏ –≤—Ö–æ–¥—É
  document.getElementById('loginFormElement').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const email = document.getElementById('loginEmail').value;
    const nickname = document.getElementById('loginNickname').value;
    const password = document.getElementById('loginPassword').value;
    const rememberMe = document.getElementById('rememberMe').checked;
    
    if (!email || !nickname || !password) {
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–ó–∞–ø–æ–≤–Ω—ñ—Ç—å —É—Å—ñ –ø–æ–ª—è', 'error');
      return;
    }
    
    try {
      // –°–ø–æ—á–∞—Ç–∫—É –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —ñ—Å–Ω—É—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ —Ç–∞–∫–∏–º –Ω—ñ–∫–Ω–µ–π–º–æ–º
      const usersRef = database.ref('users');
      const snapshot = await usersRef.orderByChild('nickname').equalTo(nickname).once('value');
      
      if (!snapshot.exists()) {
        showNotification('–ü–æ–º–∏–ª–∫–∞', '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ —Ç–∞–∫–∏–º –Ω—ñ–∫–Ω–µ–π–º–æ–º –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ', 'error');
        return;
      }
      
      // –ó–Ω–∞—Ö–æ–¥–∏–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—é –ø–æ—à—Ç–æ—é
      let userFound = false;
      let userData;
      
      snapshot.forEach((childSnapshot) => {
        const user = childSnapshot.val();
        if (user.email === email) {
          userFound = true;
          userData = user;
          userData.id = childSnapshot.key;
        }
      });
      
      if (!userFound) {
        showNotification('–ü–æ–º–∏–ª–∫–∞', '–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω—ñ–∫–Ω–µ–π–º—É', 'error');
        return;
      }
      
      // –ê–≤—Ç–æ—Ä–∏–∑—É—î–º–æ—Å—è —á–µ—Ä–µ–∑ Firebase Auth
      await auth.signInWithEmailAndPassword(email, password);
      
      // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞–Ω—ñ –≤ localStorage, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
      if (rememberMe) {
        localStorage.setItem('userEmail', email);
        localStorage.setItem('userNickname', nickname);
      } else {
        localStorage.removeItem('userEmail');
        localStorage.removeItem('userNickname');
      }
      
      showNotification('–£—Å–ø—ñ—Ö', '–í–∏ —É—Å–ø—ñ—à–Ω–æ —É–≤—ñ–π—à–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É', 'success');
      
      // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
      elements.userNameDisplay.textContent = nickname;
      elements.profilePicture.textContent = nickname.charAt(0).toUpperCase();
      
      // –ó–∞–ø–æ–≤–Ω—é—î–º–æ —Ñ–æ—Ä–º—É –ø—Ä–æ—Ñ—ñ–ª—é
      elements.profileEmail.value = email;
      elements.profileNickname.value = nickname;
      
      // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—ó –∑–º—ñ–Ω–∏
      await checkActiveShift(userData.id);
      
      // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
      await updateUserStats(userData.id);
      
      // –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –Ω–∞ –≥–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω
      showScreen('dashboardScreen');
      
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É:', error);
      
      let errorMessage = '–ù–µ –≤–¥–∞–ª–æ—Å—è —É–≤—ñ–π—Ç–∏';
      
      if (error.code === 'auth/wrong-password') {
        errorMessage = '–ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å';
      } else if (error.code === 'auth/user-not-found') {
        errorMessage = '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ —Ç–∞–∫–æ—é –ø–æ—à—Ç–æ—é –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ';
      } else if (error.code === 'auth/invalid-email') {
        errorMessage = '–ù–µ–≤—ñ—Ä–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏';
      } else if (error.code === 'auth/too-many-requests') {
        errorMessage = '–ó–∞–±–∞–≥–∞—Ç–æ —Å–ø—Ä–æ–± –≤—Ö–æ–¥—É. –°–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ';
      } else if (error.code === 'auth/network-request-failed') {
        errorMessage = '–ü—Ä–æ–±–ª–µ–º–∏ –∑ –º–µ—Ä–µ–∂–µ—é. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑\'—î–¥–Ω–∞–Ω–Ω—è';
      } else if (error.message) {
        errorMessage = error.message;
      }
      
      showNotification('–ü–æ–º–∏–ª–∫–∞', errorMessage, 'error');
    }
  });

  // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è —Ñ–æ—Ä–º–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó
  document.getElementById('registerFormElement').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const email = document.getElementById('registerEmail').value;
    const nickname = document.getElementById('registerNickname').value;
    const password = document.getElementById('registerPassword').value;
    const passwordConfirm = document.getElementById('registerPasswordConfirm').value;
    
    if (!email || !nickname || !password || !passwordConfirm) {
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–ó–∞–ø–æ–≤–Ω—ñ—Ç—å —É—Å—ñ –ø–æ–ª—è', 'error');
      return;
    }
    
    if (password !== passwordConfirm) {
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–ü–∞—Ä–æ–ª—ñ –Ω–µ —Å–ø—ñ–≤–ø–∞–¥–∞—é—Ç—å', 'error');
      return;
    }
    
    if (password.length < 6) {
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–ü–∞—Ä–æ–ª—å –º–∞—î –±—É—Ç–∏ –Ω–µ –º–µ–Ω—à–µ 6 —Å–∏–º–≤–æ–ª—ñ–≤', 'error');
      return;
    }
    
    try {
      // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —ñ—Å–Ω—É—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ —Ç–∞–∫–∏–º –Ω—ñ–∫–Ω–µ–π–º–æ–º
      const usersRef = database.ref('users');
      const snapshot = await usersRef.orderByChild('nickname').equalTo(nickname).once('value');
      
      if (snapshot.exists()) {
        showNotification('–ü–æ–º–∏–ª–∫–∞', '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ —Ç–∞–∫–∏–º –Ω—ñ–∫–Ω–µ–π–º–æ–º –≤–∂–µ —ñ—Å–Ω—É—î', 'error');
        return;
      }
      
      // –°—Ç–≤–æ—Ä—é—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ Firebase Auth
      const userCredential = await auth.createUserWithEmailAndPassword(email, password);
      const userId = userCredential.user.uid;
      
      // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ Realtime Database
      await database.ref(`users/${userId}`).set({
        email,
        nickname,
        createdAt: new Date().toISOString(),
        stats: {
          totalShifts: 0,
          totalHours: 0,
          weeklyHours: 0,
          averageTime: 0
        }
      });
      
      showNotification('–£—Å–ø—ñ—Ö', '–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞! –¢–µ–ø–µ—Ä –≤–∏ –º–æ–∂–µ—Ç–µ —É–≤—ñ–π—Ç–∏', 'success');
      
      // –ü–µ—Ä–µ–∫–ª—é—á–∞—î–º–æ—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É –≤—Ö–æ–¥—É
      switchTab('login');
      
      // –ó–∞–ø–æ–≤–Ω—é—î–º–æ –ø–æ–ª—è –≤—Ö–æ–¥—É
      document.getElementById('loginEmail').value = email;
      document.getElementById('loginNickname').value = nickname;
      
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó:', error);
      
      let errorMessage = '–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è';
      
      if (error.code === 'auth/email-already-in-use') {
        errorMessage = '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ —Ç–∞–∫–æ—é –ø–æ—à—Ç–æ—é –≤–∂–µ —ñ—Å–Ω—É—î';
      } else if (error.code === 'auth/invalid-email') {
        errorMessage = '–ù–µ–≤—ñ—Ä–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏';
      } else if (error.code === 'auth/weak-password') {
        errorMessage = '–ü–∞—Ä–æ–ª—å –∑–∞–Ω–∞–¥—Ç–æ —Å–ª–∞–±–∫–∏–π';
      } else if (error.code === 'auth/network-request-failed') {
        errorMessage = '–ü—Ä–æ–±–ª–µ–º–∏ –∑ –º–µ—Ä–µ–∂–µ—é. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑\'—î–¥–Ω–∞–Ω–Ω—è';
      } else if (error.code === 'auth/api-key-not-valid') {
        errorMessage = '–ü–æ–º–∏–ª–∫–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó Firebase. –ó–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞';
      } else if (error.message) {
        errorMessage = error.message;
      }
      
      showNotification('–ü–æ–º–∏–ª–∫–∞', errorMessage, 'error');
    }
  });

  // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ó–∞–±—É–ª–∏ –ø–∞—Ä–æ–ª—å"
  document.getElementById('forgotPasswordLink').addEventListener('click', (e) => {
    e.preventDefault();
    showScreen('forgotPasswordScreen');
  });

  // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è —Ñ–æ—Ä–º–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è
  document.getElementById('forgotPasswordForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const email = elements.resetPasswordEmail.value;
    
    if (!email) {
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–í–≤–µ–¥—ñ—Ç—å –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É', 'error');
      return;
    }
    
    try {
      await auth.sendPasswordResetEmail(email);
      
      showNotification('–£—Å–ø—ñ—Ö', '–ü–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –Ω–∞ –≤–∞—à—É –ø–æ—à—Ç—É', 'success');
      
      setTimeout(() => {
        showScreen('loginForm');
      }, 3000);
      
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è:', error);
      
      let errorMessage = '–ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è';
      
      if (error.code === 'auth/user-not-found') {
        errorMessage = '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ —Ç–∞–∫–æ—é –ø–æ—à—Ç–æ—é –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ';
      } else if (error.code === 'auth/invalid-email') {
        errorMessage = '–ù–µ–≤—ñ—Ä–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏';
      } else if (error.code === 'auth/network-request-failed') {
        errorMessage = '–ü—Ä–æ–±–ª–µ–º–∏ –∑ –º–µ—Ä–µ–∂–µ—é. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑\'—î–¥–Ω–∞–Ω–Ω—è';
      } else if (error.message) {
        errorMessage = error.message;
      }
      
      showNotification('–ü–æ–º–∏–ª–∫–∞', errorMessage, 'error');
    }
  });

  // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤–∏—Ö–æ–¥—É
  document.getElementById('logoutButton').addEventListener('click', async () => {
    try {
      await auth.signOut();
      showNotification('–£—Å–ø—ñ—Ö', '–í–∏ –≤–∏–π—à–ª–∏ –∑ —Å–∏—Å—Ç–µ–º–∏', 'success');
      showScreen('loginForm');
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –≤–∏—Ö–æ–¥—É:', error);
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–π—Ç–∏: ' + error.message, 'error');
    }
  });

  // –û–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó
  document.getElementById('backFromStartShift').addEventListener('click', () => {
    showScreen('dashboardScreen');
  });
  
  document.getElementById('backFromEndShift').addEventListener('click', () => {
    showScreen('dashboardScreen');
  });
  
  document.getElementById('backFromHistory').addEventListener('click', () => {
    showScreen('dashboardScreen');
  });
  
  document.getElementById('backFromProfile').addEventListener('click', () => {
    showScreen('dashboardScreen');
  });
  
  document.getElementById('backFromForgotPassword').addEventListener('click', () => {
    showScreen('loginForm');
  });

  // –û–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è –∫–∞—Ä—Ç–æ–∫ –¥—ñ–π
  document.getElementById('startShiftCard').addEventListener('click', () => {
    // –ó–∞–ø–æ–≤–Ω—é—î–º–æ –ø–æ–ª–µ —á–∞—Å—É –ø–æ—Ç–æ—á–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º
    elements.startShiftTime.value = getCurrentTime();
    showScreen('startShiftScreen');
  });
  
  document.getElementById('viewHistoryCard').addEventListener('click', async () => {
    const user = auth.currentUser;
    if (user) {
      showScreen('historyScreen');
      await loadShiftHistory(user.uid);
    }
  });
  
  document.getElementById('profileSettingsCard').addEventListener('click', () => {
    showScreen('profileScreen');
  });

  // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–æ—ó –∑–º—ñ–Ω–∏
  document.getElementById('endActiveShiftButton').addEventListener('click', async () => {
    const user = auth.currentUser;
    if (user) {
      const activeShift = await checkActiveShift(user.uid);
      if (activeShift) {
        elements.endShiftTime.value = getCurrentTime();
        showScreen('endShiftScreen');
      }
    }
  });

  // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è —Ñ–æ—Ä–º–∏ –ø–æ—á–∞—Ç–∫—É –∑–º—ñ–Ω–∏
  document.getElementById('startShiftForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const user = auth.currentUser;
    if (!user) {
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–í–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ', 'error');
      return;
    }
    
    const startTime = elements.startShiftTime.value;
    
    if (!startTime) {
      showNotification('–ü–æ–º–∏–ª–∫–∞',   '–í–∫–∞–∂—ñ—Ç—å —á–∞—Å –ø–æ—á–∞—Ç–∫—É –∑–º—ñ–Ω–∏', 'error');
      return;
    }
    
    try {
      // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –Ω–µ–º–∞—î –≤–∂–µ –∞–∫—Ç–∏–≤–Ω–æ—ó –∑–º—ñ–Ω–∏
      const activeShift = await checkActiveShift(user.uid);
      if (activeShift) {
        showNotification('–ü–æ–º–∏–ª–∫–∞', '–£ –≤–∞—Å –≤–∂–µ —î –∞–∫—Ç–∏–≤–Ω–∞ –∑–º—ñ–Ω–∞', 'error');
        return;
      }
      
      // –û—Ç—Ä–∏–º—É—î–º–æ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
      const userData = await loadUserData(user.uid);
      
      // –°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π –∑–∞–ø–∏—Å –∑–º—ñ–Ω–∏
      const shiftId = database.ref().child(`shifts/${user.uid}`).push().key;
      const now = new Date();
      const shiftData = {
        id: shiftId,
        startTime,
        date: now.toISOString(),
        status: 'active'
      };
      
      console.log('–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –∑–º—ñ–Ω–∏:', shiftData);
      
      // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–∞–Ω—ñ –≤ Firebase
      await database.ref(`shifts/${user.uid}/${shiftId}`).set(shiftData);
      await database.ref(`users/${user.uid}/activeShift`).set({
        shiftId,
        startTime
      });
      
      // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –¥–∞–Ω—ñ –≤ Discord
      await sendToDiscord({
        username: 'UKRAINE GTA #04',
        avatar_url: 'https://i.imgur.com/G6gEGdU.jpeg',
        embeds: [{
          color: 0x00ff00,
          title: 'üü¢ –ü–æ—á–∞—Ç–æ–∫ –æ–Ω–ª–∞–π–Ω –∑–º—ñ–Ω–∏',
          description: `**${userData.nickname}** –ø–æ—á–∞–≤(–ª–∞) –æ–Ω–ª–∞–π–Ω –∑–º—ñ–Ω—É`,
          fields: [
            {
              name: '‚è∞ –ß–∞—Å',
              value: startTime,
              inline: true
            },
            {
              name: 'üìÖ –î–∞—Ç–∞',
              value: now.toLocaleDateString('uk-UA', {
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
              }),
              inline: true
            }
          ],
          footer: {
            text: 'UKRAINE GTA #04 - –°–∏—Å—Ç–µ–º–∞ –æ–±–ª—ñ–∫—É –æ–Ω–ª–∞–π–Ω –∑–º—ñ–Ω'
          },
          timestamp: now.toISOString()
        }]
      });
      
      showNotification('–£—Å–ø—ñ—Ö', '–ó–º—ñ–Ω–∞ —É—Å–ø—ñ—à–Ω–æ —Ä–æ–∑–ø–æ—á–∞—Ç–∞', 'success');
      
      // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
      await checkActiveShift(user.uid);
      
      // –ó–∞—Ç—Ä–∏–º–∫–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –Ω–∞ –≥–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω
      setTimeout(() => {
        showScreen('dashboardScreen');
      }, 1500);
      
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –ø–æ—á–∞—Ç–∫—É –∑–º—ñ–Ω–∏:', error);
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–ù–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑–ø–æ—á–∞—Ç–∏ –∑–º—ñ–Ω—É: ' + (error.message || '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞'), 'error');
    }
  });

  // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è —Ñ–æ—Ä–º–∏ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –∑–º—ñ–Ω–∏
  document.getElementById('endShiftForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const user = auth.currentUser;
    if (!user) {
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–í–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ', 'error');
      return;
    }
    
    const endTime = elements.endShiftTime.value;
    
    if (!endTime) {
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–í–∫–∞–∂—ñ—Ç—å —á–∞—Å –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –∑–º—ñ–Ω–∏', 'error');
      return;
    }
    
    try {
      // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—ó –∑–º—ñ–Ω–∏
      const activeShift = await checkActiveShift(user.uid);
      if (!activeShift) {
        showNotification('–ü–æ–º–∏–ª–∫–∞', '–£ –≤–∞—Å –Ω–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–æ—ó –∑–º—ñ–Ω–∏', 'error');
        return;
      }
      
      // –û—Ç—Ä–∏–º—É—î–º–æ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
      const userData = await loadUserData(user.uid);
      
      // –û–±—á–∏—Å–ª—é—î–º–æ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –∑–º—ñ–Ω–∏
      const duration = calculateDuration(activeShift.startTime, endTime);
      
      console.log('–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∑–º—ñ–Ω–∏:', {
        startTime: activeShift.startTime,
        endTime,
        duration
      });
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –∑–∞–ø–∏—Å –∑–º—ñ–Ω–∏
      await database.ref(`shifts/${user.uid}/${activeShift.shiftId}`).update({
        endTime,
        duration,
        status: 'completed'
      });
      
      // –í–∏–¥–∞–ª—è—î–º–æ –∞–∫—Ç–∏–≤–Ω—É –∑–º—ñ–Ω—É
      await database.ref(`users/${user.uid}/activeShift`).remove();
      
      // –û—Ç—Ä–∏–º—É—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
      const stats = await updateUserStats(user.uid);

      // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –¥–∞–Ω—ñ –≤ Google Sheets –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é
      const now = new Date();
      await sendToGoogleSheets({
        nickname: userData.nickname,
        date: now.toLocaleDateString('uk-UA'),
        startTime: activeShift.startTime,
        endTime: endTime,
        duration: duration,
        totalShifts: stats.totalShifts,
        weeklyHours: stats.weeklyHours.toFixed(1),
        averageTime: stats.averageTime.toFixed(1)
      });
      
      // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –¥–∞–Ω—ñ –≤ Discord
      await sendToDiscord({
        username: 'UKRAINE GTA #04',
        avatar_url: 'https://i.imgur.com/G6gEGdU.jpeg',
        embeds: [{
          color: 0xff0000,
          title: 'üî¥ –ö—ñ–Ω–µ—Ü—å –æ–Ω–ª–∞–π–Ω –∑–º—ñ–Ω–∏',
          description: `**${userData.nickname}** –∑–∞–∫—ñ–Ω—á–∏–≤(–ª–∞) –æ–Ω–ª–∞–π–Ω –∑–º—ñ–Ω—É`,
          fields: [
            {
              name: '‚è∞ –ß–∞—Å –ø–æ—á–∞—Ç–∫—É',
              value: activeShift.startTime,
              inline: true
            },
            {
              name: '‚è∞ –ß–∞—Å –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è',
              value: endTime,
              inline: true
            },
            {
              name: '‚åõ –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å',
              value: duration,
              inline: true
            },
            {
              name: 'üìÖ –î–∞—Ç–∞',
              value: now.toLocaleDateString('uk-UA', {
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
              }),
              inline: true
            },
            {
              name: 'üìä –í—Å—å–æ–≥–æ –∑–º—ñ–Ω',
              value: stats.totalShifts.toString(),
              inline: true
            }
          ],
          footer: {
            text: 'UKRAINE GTA #04 - –°–∏—Å—Ç–µ–º–∞ –æ–±–ª—ñ–∫—É –æ–Ω–ª–∞–π–Ω –∑–º—ñ–Ω'
          },
          timestamp: now.toISOString()
        }]
      });
      
      showNotification('–£—Å–ø—ñ—Ö', '–ó–º—ñ–Ω–∞ —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞', 'success');
      
      // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
      await checkActiveShift(user.uid);
      
      // –ó–∞—Ç—Ä–∏–º–∫–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –Ω–∞ –≥–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω
      setTimeout(() => {
        showScreen('dashboardScreen');
      }, 1500);
      
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –∑–º—ñ–Ω–∏:', error);
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–µ—Ä—à–∏—Ç–∏ –∑–º—ñ–Ω—É: ' + (error.message || '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞'), 'error');
    }
  });

  // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è —Ñ–æ—Ä–º–∏ –ø—Ä–æ—Ñ—ñ–ª—é
  document.getElementById('profileForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const user = auth.currentUser;
    if (!user) {
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–í–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ', 'error');
      return;
    }
    
    const nickname = elements.profileNickname.value;
    const newPassword = document.getElementById('profileNewPassword').value;
    const currentPassword = document.getElementById('profileCurrentPassword').value;
    
    if (!nickname || !currentPassword) {
      showNotification('–ü–æ–º–∏–ª–∫–∞', '–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –æ–±–æ–≤\'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è', 'error');
      return;
    }
    
    try {
      // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π –ø–∞—Ä–æ–ª—å
      const credential = firebase.auth.EmailAuthProvider.credential(
        user.email,
        currentPassword
      );
      
      await user.reauthenticateWithCredential(credential);
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
      await database.ref(`users/${user.uid}`).update({
        nickname
      });
      
      // –Ø–∫—â–æ –≤–∫–∞–∑–∞–Ω–æ –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å, –æ–Ω–æ–≤–ª—é—î–º–æ –π–æ–≥–æ
      if (newPassword) {
        await user.updatePassword(newPassword);
      }
      
      showNotification('–£—Å–ø—ñ—Ö', '–ü—Ä–æ—Ñ—ñ–ª—å —É—Å–ø—ñ—à–Ω–æ –æ–Ω–æ–≤–ª–µ–Ω–æ', 'success');
      
      // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
      elements.userNameDisplay.textContent = nickname;
      elements.profilePicture.textContent = nickname.charAt(0).toUpperCase();
      
      // –ó–∞—Ç—Ä–∏–º–∫–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –Ω–∞ –≥–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω
      setTimeout(() => {
        showScreen('dashboardScreen');
      }, 1500);
      
    } catch (error) {
      console.error('–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é:', error);
      
      let errorMessage = '–ù–µ –≤–¥–∞–ª–æ—Å—è –æ–Ω–æ–≤–∏—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å';
      
      if (error.code === 'auth/wrong-password') {
        errorMessage = '–ù–µ–≤—ñ—Ä–Ω–∏–π –ø–æ—Ç–æ—á–Ω–∏–π –ø–∞—Ä–æ–ª—å';
      } else if (error.code === 'auth/weak-password') {
        errorMessage = '–ù–æ–≤–∏–π –ø–∞—Ä–æ–ª—å –∑–∞–Ω–∞–¥—Ç–æ —Å–ª–∞–±–∫–∏–π';
      } else if (error.code === 'auth/requires-recent-login') {
        errorMessage = '–ù–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ —É–≤—ñ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É –¥–ª—è –∑–º—ñ–Ω–∏ –ø–∞—Ä–æ–ª—è';
      } else if (error.message) {
        errorMessage = error.message;
      }
      
      showNotification('–ü–æ–º–∏–ª–∫–∞', errorMessage, 'error');
    }
  });

  // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —î –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–∞–Ω—ñ –¥–ª—è –≤—Ö–æ–¥—É
  document.addEventListener('DOMContentLoaded', () => {
    const savedEmail = localStorage.getItem('userEmail');
    const savedNickname = localStorage.getItem('userNickname');
    
    if (savedEmail && savedNickname) {
      document.getElementById('loginEmail').value = savedEmail;
      document.getElementById('loginNickname').value = savedNickname;
      document.getElementById('rememberMe').checked = true;
    }
    
    // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π —á–∞—Å –¥–ª—è –ø–æ–ª—ñ–≤ —á–∞—Å—É
    const currentTime = getCurrentTime();
    elements.startShiftTime.value = currentTime;
    elements.endShiftTime.value = currentTime;
    
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Å—Ç–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó
    auth.onAuthStateChanged(async (user) => {
      if (user) {
        try {
          // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
          const userData = await loadUserData(user.uid);
          
          // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
          elements.userNameDisplay.textContent = userData.nickname || '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á';
          elements.profilePicture.textContent = (userData.nickname || '–ö').charAt(0).toUpperCase();
          
          // –ó–∞–ø–æ–≤–Ω—é—î–º–æ —Ñ–æ—Ä–º—É –ø—Ä–æ—Ñ—ñ–ª—é
          elements.profileEmail.value = userData.email || user.email;
          elements.profileNickname.value = userData.nickname || '';
          
          // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—ó –∑–º—ñ–Ω–∏
          await checkActiveShift(user.uid);
          
          // –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
          await updateUserStats(user.uid);
          
          // –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –Ω–∞ –≥–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω
          showScreen('dashboardScreen');
        } catch (error) {
          console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö:', error);
          showNotification('–ü–æ–º–∏–ª–∫–∞', '–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞', 'error');
        }
      } else {
        showScreen('loginForm');
      }
    });
  });
</script>
</body>
</html>
